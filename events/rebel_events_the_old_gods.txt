#########################################################
#
# Rebel Events for The Old Gods DLC
# ( TOG.1000 to TOG.1199)
#
# NOTE: The Old Gods DLC disables the old rebel system
#
#########################################################

# Written by Henrik Fåhraeus

namespace = luxrevolt
namespace = TOG

## Revolt selection
# Triggered from on_rebel_revolt
province_event = {
	id = luxrevolt.1
	
	hide_window = yes
	is_triggered_only = yes
	has_dlc = "The Old Gods"
	
	trigger = {
		NAND = {
			has_empty_holding = yes
			owner = {
				is_nomadic = yes
			}
		}
	}
	
	immediate = {
		# add_province_modifier = { name = province_revolted duration = 1825 }
		# Check for any ongoing revolt
		if = { # Peasant revolt
			limit = {
				owner = {
					top_liege = {
						war = yes
						any_war = {
							defender = { character = PREV }
							using_cb = peasant_revolt
							war_title = ROOT
						}
					}
				}
			}
			set_province_flag = ongoing_peasant_revolt
			break = yes
		}
		if = { # Heretic revolt
			limit = {
				owner = {
					top_liege = {
						war = yes
						any_war = {
							defender = { character = PREV }
							using_cb = heretic_revolt
							war_title = ROOT
						}
					}
				}
			}
			set_province_flag = ongoing_heretic_revolt
			break = yes
		}
		if = {# Religious revolt
			limit = {
				owner = {
					top_liege = {
						war = yes
						any_war = {
							defender = { character = PREV }
							using_cb = religious_revolt
							attacker = { religion = ROOT }
						}
					}
				}
			}
			set_province_flag = ongoing_religious_revolt
			break = yes
		}
		if = { # Nationalist revolt
			limit = {
				owner = {
					top_liege = {
						war = yes
						any_war = {
							defender = { character = PREV }
							using_cb = liberation_revolt
							thirdparty_title_scope = {
								ROOT = {
									kingdom = {
										title = PREVPREV
									}
								}
							}
						}
					}
				}
			}
			set_province_flag = ongoing_nationalist_revolt
			break = yes
		}
		if = { # Slave revolt
			limit = {
				owner = {
					top_liege = {
						war = yes
						any_war = {
							defender = { character = PREV }
							OR = {
								using_cb = slave_revolt
								using_cb = war_of_liberation
							}
							war_title = ROOT
						}
					}
				}
			}
			set_province_flag = ongoing_slave_revolt
			break = yes
		}
		if = { # Martial revolt
			limit = {
				owner = {
					top_liege = {
						war = yes
						any_war = {
							defender = { character = PREV }
							using_cb = martial_revolt
							war_title = ROOT
						}
					}
				}
			}
			set_province_flag = ongoing_martial_revolt
			break = yes
		}
		if = { # Messianic revolt
			limit = {
				owner = {
					top_liege = {
						war = yes
						any_war = {
							defender = { character = PREV }
							using_cb = messianic_revolt
							war_title = ROOT
						}
					}
				}
			}
			set_province_flag = ongoing_messianic_revolt
			break = yes
		}
		if = { # Populist revolt
			limit = {
				owner = {
					top_liege = {
						war = yes
						any_war = {
							defender = { character = PREV }
							using_cb = populist_revolt
							war_title = ROOT
						}
					}
				}
			}
			set_province_flag = ongoing_populist_revolt
		}
	}
	
 	# Start a new revolt
	option = { # Start Slave revolt
		trigger = {
			NOR = {
				has_province_flag = ongoing_peasant_revolt
				has_province_flag = ongoing_religious_revolt
				has_province_flag = ongoing_nationalist_revolt
				has_province_flag = ongoing_slave_revolt
				has_province_flag = ongoing_heretic_revolt
				has_province_flag = ongoing_martial_revolt
				has_province_flag = ongoing_messianic_revolt
				has_province_flag = ongoing_populist_revolt
			}
			OR = {
				has_province_modifier = slave_modifier_1
				has_province_modifier = slave_modifier_2
				has_province_modifier = slave_modifier_3
				has_province_modifier = slave_modifier_4
				has_province_modifier = slave_modifier_5
			}
			kingdom = {
				OR = {
					has_holder = no
					holder_scope = { any_realm_province = { province_id = ROOT } }
				}
			}
		}
		province_event = { id = luxrevolt.1080 }
		ai_chance = {
			factor = 1000
		}
	}
	option = { # Start nationalist revolt
		trigger = {
			NOR = {
				has_province_flag = ongoing_peasant_revolt
				has_province_flag = ongoing_religious_revolt
				has_province_flag = ongoing_nationalist_revolt
				has_province_flag = ongoing_slave_revolt
				has_province_flag = ongoing_heretic_revolt
				has_province_flag = ongoing_martial_revolt
				has_province_flag = ongoing_messianic_revolt
				has_province_flag = ongoing_populist_revolt
			}
			owner = {
				top_liege = {
					NOT = { culture = ROOT }
				}
			}
			kingdom = {
				culture = ROOT
				has_holder = no
				any_previous_holder = { # Must have had a holder in the past
					ROOT = {
						owner = {
							top_liege = {
								NOT = { dynasty = PREVPREVPREV }
								OR = {
									is_nomadic = no
									NOT = { culture_group = ROOT }
								}
							}
						}
					}
				}
			}
		}
		province_event = { id = TOG.1040 }
		ai_chance = {
			factor = 1000
		}
	}
	option = { # Start religious revolt
		trigger = {
			NOR = {
				has_province_flag = ongoing_peasant_revolt
				has_province_flag = ongoing_religious_revolt
				has_province_flag = ongoing_nationalist_revolt
				has_province_flag = ongoing_slave_revolt
				has_province_flag = ongoing_heretic_revolt
				has_province_flag = ongoing_martial_revolt
				has_province_flag = ongoing_messianic_revolt
				has_province_flag = ongoing_populist_revolt
			}
			owner = {
				top_liege = {
					NOT = { religion_group = ROOT }
				}
			}
		}
		province_event = { id = TOG.1060 }
		ai_chance = {
			factor = 100
			# modifier = { factor = 0.1 religion = spider } # It's not really religion that would openly try to revolt 
		}
	}
	option = { # Start heretic revolt
		trigger = {
			NOR = {
				has_province_flag = ongoing_peasant_revolt
				has_province_flag = ongoing_religious_revolt
				has_province_flag = ongoing_nationalist_revolt
				has_province_flag = ongoing_slave_revolt
				has_province_flag = ongoing_heretic_revolt
				has_province_flag = ongoing_martial_revolt
				has_province_flag = ongoing_messianic_revolt
				has_province_flag = ongoing_populist_revolt
			}
			is_heretic = yes
			owner = {
				top_liege = {
					is_parent_religion = ROOT
				}
			}
		}
		province_event = { id = TOG.1020 }
		ai_chance = {
			factor = 100
		}
	}
	option = { # Start peasant revolt
		trigger = {
			NOR = {
				has_province_flag = ongoing_peasant_revolt
				has_province_flag = ongoing_religious_revolt
				has_province_flag = ongoing_nationalist_revolt
				has_province_flag = ongoing_slave_revolt
				has_province_flag = ongoing_heretic_revolt
				has_province_flag = ongoing_martial_revolt
				has_province_flag = ongoing_messianic_revolt
				has_province_flag = ongoing_populist_revolt
			}
		}
		province_event = { id = TOG.1000 }
		ai_chance = {
			factor = 10
		}
	}
	option = { # Start martial revolt
		trigger = {
			NOR = {
				has_province_flag = ongoing_peasant_revolt
				has_province_flag = ongoing_religious_revolt
				has_province_flag = ongoing_nationalist_revolt
				has_province_flag = ongoing_slave_revolt
				has_province_flag = ongoing_heretic_revolt
				has_province_flag = ongoing_martial_revolt
				has_province_flag = ongoing_messianic_revolt
				has_province_flag = ongoing_populist_revolt
			}
			martial_religion_trigger = yes
		}
		province_event = { id = luxrevolt.1000 }
		ai_chance = {
			factor = 10
		}
	}
	option = { # Start messianic revolt
		trigger = {
			NOR = {
				has_province_flag = ongoing_peasant_revolt
				has_province_flag = ongoing_religious_revolt
				has_province_flag = ongoing_nationalist_revolt
				has_province_flag = ongoing_slave_revolt
				has_province_flag = ongoing_heretic_revolt
				has_province_flag = ongoing_martial_revolt
				has_province_flag = ongoing_messianic_revolt
				has_province_flag = ongoing_populist_revolt
			}
			messianic_soul_trigger = yes
			owner = {
				top_liege = {
					OR = {
						NOT = { religion = ROOT }
						trait = cynical
						trait = tolerant
					}
				}
			}
		}
		province_event = { id = luxrevolt.1020 }
		ai_chance = {
			factor = 10
		}
	}
	option = { # Start populist revolt
		trigger = {
			NOR = {
				has_province_flag = ongoing_peasant_revolt
				has_province_flag = ongoing_religious_revolt
				has_province_flag = ongoing_nationalist_revolt
				has_province_flag = ongoing_slave_revolt
				has_province_flag = ongoing_heretic_revolt
				has_province_flag = ongoing_martial_revolt
				has_province_flag = ongoing_messianic_revolt
				has_province_flag = ongoing_populist_revolt
			}
			populist_soul_trigger = yes
			owner = {
				top_liege = {
					OR = {
						NOT = {
							religion = ROOT
						}
						trait = greedy
						trait = cruel
						AND = {
							has_law = people_control_0
							NOT = { piety = 0 }
						}
						AND = {
							has_law = people_control_1
							NOT = { piety = 50 }
						}
						AND = {
							has_law = people_control_2
							NOT = { piety = 100 }
						}
						AND = {
							has_law = people_control_3
							NOT = { piety = 150 }
						}
						AND = {
							has_law = people_control_4
							NOT = { piety = 200 }
						}
					}
				}
			}
		}
		province_event = { id = luxrevolt.1040 }
		ai_chance = {
			factor = 10
		}
	}
	# Reinforce the ongoing revolt
	option = { # Reinforce Slave revolt
		trigger = {
			has_province_flag = ongoing_slave_revolt
		}
		province_event = { id = luxrevolt.1090 }
		clr_province_flag = ongoing_peasant_revolt
		clr_province_flag = ongoing_religious_revolt
		clr_province_flag = ongoing_nationalist_revolt
		clr_province_flag = ongoing_slave_revolt
		clr_province_flag = ongoing_heretic_revolt
		clr_province_flag = ongoing_martial_revolt
		clr_province_flag = ongoing_messianic_revolt
		clr_province_flag = ongoing_populist_revolt
		ai_chance = {
			factor = 10000
		}
	}
	option = { # Reinforce nationalist revolt
		trigger = {
			has_province_flag = ongoing_nationalist_revolt
		}
		province_event = { id = TOG.1050 }
		clr_province_flag = ongoing_peasant_revolt
		clr_province_flag = ongoing_religious_revolt
		clr_province_flag = ongoing_nationalist_revolt
		clr_province_flag = ongoing_slave_revolt
		clr_province_flag = ongoing_heretic_revolt
		clr_province_flag = ongoing_martial_revolt
		clr_province_flag = ongoing_messianic_revolt
		clr_province_flag = ongoing_populist_revolt
		ai_chance = {
			factor = 1000
		}
	}
	option = { # Reinforce heretic revolt
		trigger = {
			has_province_flag = ongoing_heretic_revolt
		}
		province_event = { id = TOG.1030 }
		clr_province_flag = ongoing_peasant_revolt
		clr_province_flag = ongoing_religious_revolt
		clr_province_flag = ongoing_nationalist_revolt
		clr_province_flag = ongoing_slave_revolt
		clr_province_flag = ongoing_heretic_revolt
		clr_province_flag = ongoing_martial_revolt
		clr_province_flag = ongoing_messianic_revolt
		clr_province_flag = ongoing_populist_revolt
		ai_chance = {
			factor = 1000
		}
	}
	option = { # Reinforce religious revolt
		trigger = {
			has_province_flag = ongoing_religious_revolt
		}
		province_event = { id = TOG.1070 }
		clr_province_flag = ongoing_peasant_revolt
		clr_province_flag = ongoing_religious_revolt
		clr_province_flag = ongoing_nationalist_revolt
		clr_province_flag = ongoing_slave_revolt
		clr_province_flag = ongoing_heretic_revolt
		clr_province_flag = ongoing_martial_revolt
		clr_province_flag = ongoing_messianic_revolt
		clr_province_flag = ongoing_populist_revolt
		ai_chance = {
			factor = 100
		}
	}
	option = { # Reinforce peasant revolt
		trigger = {
			has_province_flag = ongoing_peasant_revolt
		}
		province_event = { id = TOG.1010 }
		clr_province_flag = ongoing_peasant_revolt
		clr_province_flag = ongoing_religious_revolt
		clr_province_flag = ongoing_nationalist_revolt
		clr_province_flag = ongoing_slave_revolt
		clr_province_flag = ongoing_heretic_revolt
		clr_province_flag = ongoing_martial_revolt
		clr_province_flag = ongoing_messianic_revolt
		clr_province_flag = ongoing_populist_revolt
		ai_chance = {
			factor = 10
		}
	}
	option = { # Reinforce martial revolt
		trigger = {
			has_province_flag = ongoing_martial_revolt
			martial_religion_trigger = yes
			owner = {
				top_liege = {
					OR = {
						NOT = {
							religion = ROOT
						}
						trait = weak
						trait = slothful
						NOT = {
							prestige = 0
						}
					}
				}
			}
		}
		province_event = { id = luxrevolt.1010 }
		clr_province_flag = ongoing_peasant_revolt
		clr_province_flag = ongoing_religious_revolt
		clr_province_flag = ongoing_nationalist_revolt
		clr_province_flag = ongoing_slave_revolt
		clr_province_flag = ongoing_heretic_revolt
		clr_province_flag = ongoing_martial_revolt
		clr_province_flag = ongoing_messianic_revolt
		clr_province_flag = ongoing_populist_revolt
		ai_chance = {
			factor = 10
		}
	}
	option = { # Reinforce messianic revolt
		trigger = {
			messianic_soul_trigger = yes
			has_province_flag = ongoing_messianic_revolt
		}
		province_event = { id = luxrevolt.1030 }
		clr_province_flag = ongoing_peasant_revolt
		clr_province_flag = ongoing_religious_revolt
		clr_province_flag = ongoing_nationalist_revolt
		clr_province_flag = ongoing_slave_revolt
		clr_province_flag = ongoing_heretic_revolt
		clr_province_flag = ongoing_martial_revolt
		clr_province_flag = ongoing_messianic_revolt
		clr_province_flag = ongoing_populist_revolt
		ai_chance = {
			factor = 10
		}
	}
	option = { # Reinforce populist revolt
		trigger = {
			has_province_flag = ongoing_populist_revolt
			populist_soul_trigger = yes
		}
		province_event = { id = luxrevolt.1050 }
		clr_province_flag = ongoing_peasant_revolt
		clr_province_flag = ongoing_religious_revolt
		clr_province_flag = ongoing_nationalist_revolt
		clr_province_flag = ongoing_slave_revolt
		clr_province_flag = ongoing_heretic_revolt
		clr_province_flag = ongoing_martial_revolt
		clr_province_flag = ongoing_messianic_revolt
		clr_province_flag = ongoing_populist_revolt
		ai_chance = {
			factor = 10
		}
	}
	# Don't revolt
	# option = { # Do nothing
		# name = OK
		# clr_province_flag = ongoing_peasant_revolt
		# clr_province_flag = ongoing_religious_revolt
		# clr_province_flag = ongoing_nationalist_revolt
		# clr_province_flag = ongoing_slave_revolt
		# ai_chance = {
			# factor = 10000
			# modifier = {
				# factor = 0
				# NOT = {
					# terrain = dryad_forest
					# owner = { trait = dryad }
				# }
			# }
		# }
	# }
}


# Peasant Rebels rise up (temporary rebel title created, with a leader and a war)
# Triggered from [s]"on_rebel_revolt"[/s] luxrevolt.1
province_event = {
	id = TOG.1000
	desc = EVTDESC_TOG_1000
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		remove_province_modifier = rumors_of_witchcraft

		create_character = {
			random_traits = yes
			dynasty = none
			religion = ROOT
			culture = ROOT
			female = no
			age = 25
			attributes = {
				martial = 5
			}
			trait = peasant_leader
			trait = tough_soldier
		}
		
		new_character = {
			create_title = {
				tier = DUKE
				landless = yes
				temporary = yes
				rebel = yes
				culture = ROOT
				name = "PEASANT_REVOLT"
				holder = THIS
			}
			
			wealth = 100
			
			spawn_peasant_army_effect = yes
			
			if = {
				limit = {
					has_game_rule = {
						name = provincial_revolt_strength
						value = powerful
					}
				}
				spawn_peasant_army_effect = yes
				wealth = 150
			}
			
			if = {
				limit = {
					has_game_rule = {
						name = provincial_revolt_strength
						value = very_powerful
					}
				}
				spawn_peasant_army_effect = yes
				spawn_peasant_army_effect = yes
				spawn_peasant_army_effect = yes
				wealth = 250
			}
			
			if = {
				limit = {
					has_game_rule = {
						name = provincial_revolt_strength
						value = extremely_powerful
					}
				}
				spawn_peasant_army_effect = yes
				spawn_peasant_army_effect = yes
				spawn_peasant_army_effect = yes
				spawn_peasant_army_effect = yes
				spawn_peasant_army_effect = yes
				wealth = 350
			}
			
			# DoW on the province top liege
			ROOT = {
				owner = {
					top_liege = {
#						set_defacto_vassal = PREVPREVPREV
						reverse_war = {
							target = PREVPREVPREV
							casus_belli = peasant_revolt
							thirdparty_title = ROOT # The county
						}
						reverse_opinion = {
							who = PREVPREVPREV
							modifier = opinion_evil_tyrant
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = TOG.1001
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1000"
	}
}

#Inform lieges of new peasant revolt
character_event = {
	id = TOG.1001
	desc = EVTDESC_TOG_1001
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_TOG_1000"
	}
}

# Peasants seize a holding. Fired from 'on_siege_won_leader'.
character_event = {
	id = TOG.1005
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		trait = peasant_leader
		rebel = yes
		FROM = { 
			is_capital = yes # The capital holding
		}
	}
	
	immediate = {
		FROM = {
			location = {
				if = {
					limit = {
						NOT = { has_province_modifier = peasant_unrest }
					}
					add_province_modifier = {
						name = peasant_unrest
						duration = 730
					}
				}
			}
		}
	}
}

# Peasant Rebels rise up to reinforce an ongoing provincial peasant revolt
# Triggered from [s]"on_rebel_revolt"[/s] luxrevolt.1
province_event = {
	id = TOG.1010
	desc = EVTDESC_TOG_1010
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		
		add_province_modifier = {
			name = recent_county_uprising
			duration = 1825 # Five years of -100% revolt risk in this county
		}
		
		owner = {
			top_liege = {
				any_war = {
					limit = {
						defender = { character = PREV }
						using_cb = peasant_revolt
						war_title = ROOT # The county
					}
					attacker = {
						spawn_peasant_reinforcements_effect = yes
						
						if = {
							limit = {
								has_game_rule = {
									name = provincial_revolt_strength
									value = powerful
								}
							}
							spawn_peasant_reinforcements_effect = yes
						}
						
						if = {
							limit = {
								has_game_rule = {
									name = provincial_revolt_strength
									value = very_powerful
								}
							}
							spawn_peasant_reinforcements_effect = yes
							spawn_peasant_reinforcements_effect = yes
							spawn_peasant_reinforcements_effect = yes
						}
						
						if = {
							limit = {
								has_game_rule = {
									name = provincial_revolt_strength
									value = extremely_powerful
								}
							}
							spawn_peasant_reinforcements_effect = yes
							spawn_peasant_reinforcements_effect = yes
							spawn_peasant_reinforcements_effect = yes
							spawn_peasant_reinforcements_effect = yes
							spawn_peasant_reinforcements_effect = yes
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = TOG.1011
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1010"
	}
}

#Inform lieges of reinforced peasant revolt
character_event = {
	id = TOG.1011
	desc = EVTDESC_TOG_1011
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_TOG_1010"
	}
}

# Heretic Rebels rise up (temporary rebel title created, with a leader and a war)
# Triggered from [s]"on_rebel_revolt"[/s] luxrevolt.1
province_event = {
	id = TOG.1020
	desc = EVTDESC_TOG_1020
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			random_traits = yes
			dynasty = none
			religion = ROOT
			culture = ROOT
			female = no
			age = 32
			attributes = {
				martial = 7
				learning = 7
			}
			trait = heresiarch
			trait = zealous
			trait = scholar
			trait = skilled_tactician
		}
		
		new_character = {
			set_character_flag = heretic_revolter
			
			create_title = {
				tier = DUKE
				landless = yes
				temporary = yes
				rebel = yes
				culture = ROOT
				name = "HERETIC_REVOLT"
				holder = THIS
			}
			
			wealth = 100
			
			spawn_heretic_army_effect = yes
			
			if = {
				limit = {
					has_game_rule = {
						name = provincial_revolt_strength
						value = powerful
					}
				}
				spawn_heretic_army_effect = yes
				wealth = 150
			}
			
			if = {
				limit = {
					has_game_rule = {
						name = provincial_revolt_strength
						value = very_powerful
					}
				}
				spawn_heretic_army_effect = yes
				spawn_heretic_army_effect = yes
				spawn_heretic_army_effect = yes
				wealth = 250
			}
			
			if = {
				limit = {
					has_game_rule = {
						name = provincial_revolt_strength
						value = extremely_powerful
					}
				}
				spawn_heretic_army_effect = yes
				spawn_heretic_army_effect = yes
				spawn_heretic_army_effect = yes
				spawn_heretic_army_effect = yes
				spawn_heretic_army_effect = yes
				wealth = 350
			}
			
			# DoW on the province top liege
			ROOT = {
				owner = {
					top_liege = {
						reverse_war = {
							target = PREVPREVPREV
							casus_belli = heretic_revolt
							thirdparty_title = ROOT # The county...
							tier = DUKE # ... but really the de jure duchy
						}
						reverse_opinion = {
							who = PREVPREVPREV
							modifier = opinion_evil_tyrant
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = TOG.1021
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1020"
	}
}

#Inform lieges of new heretic rebellion
character_event = {
	id = TOG.1021
	desc = EVTDESC_TOG_1021
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TOG_1020
	}
}

# Heretics seize a holding. Fired from 'on_siege_won_leader'.
character_event = {
	id = TOG.1025
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		trait = heresiarch
		rebel = yes
		FROM = { 
			is_capital = yes # The capital holding
		}
	}
	
	immediate = {
		FROM = {
			location = {
				if = {
					limit = {
						NOT = { religion = ROOT }
					}
					random = {
						chance = 50
						religion = ROOT
					}
				}
				if = {
					limit = {
						NOT = { has_province_modifier = religious_unrest }
					}
					add_province_modifier = {
						name = religious_unrest
						duration = 730
					}
				}
			}
		}
	}
}

# Heretic Rebels rise up to reinforce an ongoing heretic uprising
# Triggered from [s]"on_rebel_revolt"[/s] luxrevolt.1
province_event = {
	id = TOG.1030
	desc = EVTDESC_TOG_1030
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
	
		add_province_modifier = {
			name = recent_county_uprising
			duration = 1825 # Five years of -100% revolt risk in this county
		}
	
		owner = {
			top_liege = {
				any_war = {
					limit = {
						defender = { character = PREV }
						using_cb = heretic_revolt
						attacker = { religion = ROOT }
					}
					attacker = {
						spawn_heretic_reinforcements_effect = yes
						
						if = {
							limit = {
								has_game_rule = {
									name = provincial_revolt_strength
									value = powerful
								}
							}
							spawn_heretic_reinforcements_effect = yes
						}
						
						if = {
							limit = {
								has_game_rule = {
									name = provincial_revolt_strength
									value = very_powerful
								}
							}
							spawn_heretic_reinforcements_effect = yes
							spawn_heretic_reinforcements_effect = yes
							spawn_heretic_reinforcements_effect = yes
						}
						
						if = {
							limit = {
								has_game_rule = {
									name = provincial_revolt_strength
									value = extremely_powerful
								}
							}
							spawn_heretic_reinforcements_effect = yes
							spawn_heretic_reinforcements_effect = yes
							spawn_heretic_reinforcements_effect = yes
							spawn_heretic_reinforcements_effect = yes
							spawn_heretic_reinforcements_effect = yes
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = TOG.1031
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1030"
	}
}

#Lieges are informed of reinforced heretic uprising
character_event = {
	id = TOG.1031
	desc = EVTDESC_TOG_1031
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_TOG_1030"
	}
}

# Royalist Nationalist Rebels rise up to create a kingdom (temporary rebel title created, with a leader and a war)
# Triggered from [s]"on_rebel_revolt"[/s] luxrevolt.1
province_event = {
	id = TOG.1040
	desc = EVTDESC_TOG_1040
	picture = GFX_evt_siege
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			random_traits = yes
			dynasty = random
			religion = ROOT
			culture = ROOT
			female = no
			age = 20
			health = 7
			fertility = 0.7
			attributes = {
				martial = 8
				diplomacy = 9
			}
			trait = just
			trait = brave
			trait = gregarious
			trait = ambitious
			trait = brilliant_strategist
			trait = inspiring_leader
		}
		
		new_character = {
			set_character_flag = nationalist_rebel
			
			create_title = {
				tier = DUKE
				landless = yes
				temporary = yes
				rebel = yes
				culture = ROOT
				name = "NATIONALIST_REVOLT"
				holder = THIS
			}
			
			wealth = 100
			
			spawn_unit = {
				province = ROOT
				home = ROOT
				owner = THIS
				#leader = THIS
				scaled_by_biggest_garrison = 1.75
				troops = {
					archers = { 6 6 }
					light_cavalry = { 3 3 }
					knights = { 1 1 }
					light_infantry = { 7 7 }
					heavy_infantry = { 3 3 }
				}
				attrition = 1.0
			}
			
			spawn_nationalist_army_effect = yes
			
			if = {
				limit = {
					has_game_rule = {
						name = provincial_revolt_strength
						value = powerful
					}
				}
				spawn_nationalist_army_effect = yes
				wealth = 150
			}
			
			if = {
				limit = {
					has_game_rule = {
						name = provincial_revolt_strength
						value = very_powerful
					}
				}
				spawn_nationalist_army_effect = yes
				spawn_nationalist_army_effect = yes
				spawn_nationalist_army_effect = yes
				wealth = 250
			}
			
			if = {
				limit = {
					has_game_rule = {
						name = provincial_revolt_strength
						value = extremely_powerful
					}
				}
				spawn_nationalist_army_effect = yes
				spawn_nationalist_army_effect = yes
				spawn_nationalist_army_effect = yes
				spawn_nationalist_army_effect = yes
				spawn_nationalist_army_effect = yes
				wealth = 350
			}
			
			# DoW on the province top liege
			ROOT = {
				owner = {
					top_liege = {
						reverse_war = {
							target = PREVPREVPREV
							casus_belli = liberation_revolt
							thirdparty_title = ROOT # The county...
							tier = KING # ... but really the de jure kingdom
						}
						reverse_opinion = {
							who = PREVPREVPREV
							modifier = opinion_evil_tyrant
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = TOG.1041
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1040"
	}
}

#Lieges are informed of new nationalist rebellion
character_event = {
	id = TOG.1041
	desc = EVTDESC_TOG_1041
	picture = GFX_evt_siege
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TOG_1040
	}
}

# Nationalists seize a holding. Fired from 'on_siege_won_leader'.
character_event = {
	id = TOG.1045
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		rebel = yes
		FROM = { 
			is_capital = yes # The capital holding
		}
		any_war = {
			attacker = { character = ROOT }
			using_cb = liberation_revolt
		}
	}
	
	immediate = {
		FROM = {
			location = {
				if = {
					limit = {
						NOT = { culture = ROOT }
						kingdom = { culture = ROOT }
					}
					random = {
						chance = 20
						culture = ROOT
					}
				}
				if = {
					limit = {
						culture = ROOT
						NOT = { has_province_modifier = cultural_unrest }
					}
					add_province_modifier = {
						name = cultural_unrest
						duration = 730
					}
				}
			}
		}
	}
}

# Nationalist Rebels rise up to reinforce an ongoing revolt
# Triggered from [s]"on_rebel_revolt"[/s] luxrevolt.1
province_event = {
	id = TOG.1050
	desc = EVTDESC_TOG_1050
	picture = GFX_evt_siege
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes

	trigger = {
		has_dlc = "The Old Gods"

		any_province_holding = {
			NOT = { holding_type = nomad }
		}
		
		# There is already an ongoing nationalist revolt for the same kingdom
		owner = {
			top_liege = {
				war = yes
				any_war = {
					defender = { character = PREV }
					using_cb = liberation_revolt
					thirdparty_title_scope = {
						ROOT = {
							kingdom = {
								title = PREVPREV
							}
						}
					}
				}
			}
		}
	}
	
	immediate = {
		add_province_modifier = {
			name = recent_county_uprising
			duration = 1825 # Five years of -100% revolt risk in this county
		}
		owner = {
			top_liege = {
				any_war = {
					limit = {
						defender = { character = PREV }
						using_cb = liberation_revolt
						thirdparty_title_scope = {
							ROOT = {
								kingdom = {
									title = PREVPREV
								}
							}
						}
					}
					attacker = {
						spawn_nationalist_reinforcements_effect = yes
						
						if = {
							limit = {
								has_game_rule = {
									name = provincial_revolt_strength
									value = powerful
								}
							}
							spawn_nationalist_reinforcements_effect = yes
						}
						
						if = {
							limit = {
								has_game_rule = {
									name = provincial_revolt_strength
									value = very_powerful
								}
							}
							spawn_nationalist_reinforcements_effect = yes
							spawn_nationalist_reinforcements_effect = yes
							spawn_nationalist_reinforcements_effect = yes
						}
						
						if = {
							limit = {
								has_game_rule = {
									name = provincial_revolt_strength
									value = extremely_powerful
								}
							}
							spawn_nationalist_reinforcements_effect = yes
							spawn_nationalist_reinforcements_effect = yes
							spawn_nationalist_reinforcements_effect = yes
							spawn_nationalist_reinforcements_effect = yes
							spawn_nationalist_reinforcements_effect = yes
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = TOG.1051
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1000"
	}
}

#Lieges are informed of reinforced nationalist revolt
character_event = {
	id = TOG.1051
	desc = EVTDESC_TOG_1051
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TOG_1000
	}
}

# Religious Rebels rise up (temporary rebel title created, with a leader and a war)
# Triggered from [s]"on_rebel_revolt"[/s] luxrevolt.1
province_event = {
	id = TOG.1060
	desc = EVTDESC_TOG_1060
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			random_traits = yes
			dynasty = none
			religion = ROOT
			culture = ROOT
			female = no
			age = 32
			attributes = {
				martial = 7
				learning = 7
			}
			trait = zealous
			trait = scholar
			trait = skilled_tactician
		}
		
		new_character = {
			set_character_flag = religious_revolter
			
			create_title = {
				tier = DUKE
				landless = yes
				temporary = yes
				rebel = yes
				culture = ROOT
				name = "HERETIC_REVOLT"
				holder = THIS
			}
			
			wealth = 100
			
			spawn_religious_army_effect = yes
			
			if = {
				limit = {
					has_game_rule = {
						name = provincial_revolt_strength
						value = powerful
					}
				}
				spawn_religious_army_effect = yes
				wealth = 150
			}
			
			if = {
				limit = {
					has_game_rule = {
						name = provincial_revolt_strength
						value = very_powerful
					}
				}
				spawn_religious_army_effect = yes
				spawn_religious_army_effect = yes
				spawn_religious_army_effect = yes
				wealth = 250
			}
			
			if = {
				limit = {
					has_game_rule = {
						name = provincial_revolt_strength
						value = extremely_powerful
					}
				}
				spawn_religious_army_effect = yes
				spawn_religious_army_effect = yes
				spawn_religious_army_effect = yes
				spawn_religious_army_effect = yes
				spawn_religious_army_effect = yes
				wealth = 350
			}
			
			# DoW on the province top liege
			ROOT = {
				owner = {
					top_liege = {
						reverse_war = {
							target = PREVPREVPREV
							casus_belli = religious_revolt
							thirdparty_title = ROOT # The county...
							tier = DUKE # ... but really the de jure duchy
						}
						reverse_opinion = {
							who = PREVPREVPREV
							modifier = opinion_evil_tyrant
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = TOG.1061
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_TOG_1060
		trigger = {
			owner = { religion_group = ROOT }
		}
	}
	option = {
		name = EVTOPTB_TOG_1060
		trigger = {
			owner = { NOT = { religion_group = ROOT	} }
		}
	}
}

#Inform lieges of new religious rebellion
character_event = {
	id = TOG.1061
	desc = EVTDESC_TOG_1061
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_TOG_1060
		trigger = {
			religion_group = FROM
		}
	}
	option = {
		name = EVTOPTB_TOG_1060
		trigger = {
			NOT = { religion_group = FROM	}
		}
	}
}

# Religious Rebels seize a holding. Fired from 'on_siege_over_winner'. Owner of the winning unit is ROOT. The taken Holding title is in FROM.
character_event = {
	id = TOG.1065
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_character_flag = religious_revolter
		rebel = yes
		FROM = { 
			is_capital = yes # The capital holding
		}
	}
	
	immediate = {
		FROM = {
			location = {
				if = {
					limit = {
						NOT = { religion = ROOT }
					}
					random = {
						chance = 5
						religion = ROOT
					}
				}
				if = {
					limit = {
						NOT = { has_province_modifier = religious_unrest }
					}
					add_province_modifier = {
						name = religious_unrest
						duration = 730
					}
				}
			}
		}
	}
}

# Religious Rebels rise up to reinforce an ongoing heretic uprising
# Triggered from [s]"on_rebel_revolt"[/s] luxrevolt.1
province_event = {
	id = TOG.1070
	desc = EVTDESC_TOG_1070
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
	
		add_province_modifier = {
			name = recent_county_uprising
			duration = 1825 # Five years of -100% revolt risk in this county
		}
	
		owner = {
			top_liege = {
				any_war = {
					limit = {
						defender = { character = PREV }
						using_cb = religious_revolt
						attacker = { religion = ROOT }
					}
					attacker = {
						spawn_religious_reinforcements_effect = yes
						
						if = {
							limit = {
								has_game_rule = {
									name = provincial_revolt_strength
									value = powerful
								}
							}
							spawn_religious_reinforcements_effect = yes
						}
						
						if = {
							limit = {
								has_game_rule = {
									name = provincial_revolt_strength
									value = very_powerful
								}
							}
							spawn_religious_reinforcements_effect = yes
							spawn_religious_reinforcements_effect = yes
							spawn_religious_reinforcements_effect = yes
						}
						
						if = {
							limit = {
								has_game_rule = {
									name = provincial_revolt_strength
									value = extremely_powerful
								}
							}
							spawn_religious_reinforcements_effect = yes
							spawn_religious_reinforcements_effect = yes
							spawn_religious_reinforcements_effect = yes
							spawn_religious_reinforcements_effect = yes
							spawn_religious_reinforcements_effect = yes
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = TOG.1071
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1070"
	}
}

#inform lieges of reinforced religious rebellion
character_event = {
	id = TOG.1071
	desc = EVTDESC_TOG_1071
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_TOG_1070"
	}
}

# Rebels kill a local character. Fired from 'on_siege_over_loc_chars'.
# Siege winner unit owner in the 'new_character' scope, lost holding title in FROM, local character in ROOT.
character_event = {
	id = TOG.1190
	desc = EVTDESC_TOG_1190
	picture = GFX_evt_beheading
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	trigger = {
		new_character = {
			rebel = yes
			
			OR = {
				NOT = { religion = ROOT }
				AND = {
					NOT = { has_character_flag = heretic_revolter }
					NOT = { has_character_flag = religious_revolter }
					NOT = { has_character_flag = shepherds_crusade_leader }
				}
			}
		}
	}
	
	weight_multiplier = {
		days = 1
		modifier = {
			factor = 0.5
			is_female = yes
		}
		modifier = {
			factor = 0.5
			is_adult = no
		}
	}
	
	immediate = {
		any_liege = { # Inform the victim's lieges
			character_event = {
				id = TOG.1191
			}
		}
		new_character = {
			ROOT = {
				death = {
					death_reason = death_rabble
					#killer = PREV
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_TOG_1190
	}
}


# Lieges informed
character_event = {
	id = TOG.1191
	picture = GFX_evt_beheading
	desc = EVTDESC_TOG_1191
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	notification = yes
	
	ai = no
	
	option = {
		name = EVTOPTA_TOG_1191
	}
}


# Messianic revolt "theocratizer" event.
character_event = {
	id = luxrevolt.1064
	desc = EVTDESCluxrevolt.1064
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	trigger = {
		any_vassal = {
			is_theocracy = yes
			tier = baron
		}
		FROM = {
			location = {
				is_capital = yes
			}
		}
	}
	
	option = {
	name = JACKALS
		random_vassal = {
			limit = {
				is_theocracy = yes
				tier = baron
			}
			capital_holding = {
				ROOT = {
					primary_title = {
						usurp_title = PREVPREVPREV
					}
				}
				location = {
					PREVPREV = {
						capital = PREV
					}
				}
			}
		}	
	}
}
# Populist revolt "democratizer" event.
character_event = {
	id = luxrevolt.1084
	desc = EVTDESCluxrevolt.1084
	picture = GFX_evt_heretic
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	trigger = {
		any_vassal = {
			is_republic = yes
			tier = baron
		}
		FROM = {
			location = {
				is_capital = yes
			}
		}
	}
	
	option = {
		name = JACKALS
		random_vassal = {
			limit = {
				is_republic = yes
				tier = baron
			}
			capital_holding = {
				ROOT = {
					primary_title = {
						usurp_title = PREVPREVPREV
					}
				}
				location = {
					PREVPREV = {
						capital = PREV
					}
				}
			}
		}	
	}
}


#Slaves rise up (temporary rebel title created, with a leader and a war)
#Triggered from "on_rebel_revolt"
province_event = {
	id = luxrevolt.1080
	is_triggered_only = yes
	hide_window = yes

	immediate = {
		add_province_modifier = {
			name = recent_county_uprising
			duration = 1825 # Five years of -100% revolt risk in this county
		}
		set_province_flag = slave_revolt
		if = { #try and find existing slave
			limit = { ROOT = { NOT = { has_province_flag = slave_leader_found } } }		
			owner = {
				random_realm_character = {
					limit = {
						trait = slave
						is_adult = yes
						prisoner = no
						is_ill = no
						NOT = { trait = incapable }
						diplomacy = 8
						martial = 8
						OR = {
							trait = ambitious
							trait = brave
							trait = liberator
							is_strong_trigger = yes
						}
						NOT = { trait = craven }
						NOT = { trait = content }
						NOT = { is_weak_trigger = yes }
						NOT = { trait = shy }
					}
					ROOT = { set_province_flag = slave_leader_found }
					character_event = { id = slavery.0 } #remove slave trait
					add_trait = liberator
					set_character_flag = escaped_slave
					set_character_flag = slave_rebel
					move_character = PREV
				}	
			}
		}	
		if = { #Else create random slave leader
			limit = { ROOT = { NOT = { has_province_flag = slave_leader_found } } }
			owner = {
				create_character = {
					random_traits = yes
					dynasty = none
					religion = ROOT
					culture = random
					female = no
					age = 25
					attributes = {
						martial = 5
					}
					trait = liberator
					trait = former_slave
					trait = tough_soldier			
				}		
				new_character = {
					set_character_flag = slave_rebel
					set_character_flag = escaped_slave
					random_list = {
						20 = { add_trait = skilled_warrior }
						40 = { add_trait = trained_warrior }
						40 = { add_trait = poor_warrior }
					}					
				}
			}
		}	
		clr_province_flag = slave_leader_found
		owner = {
			random_courtier = {
				limit = { has_character_flag = slave_rebel }
				create_title = {
					tier = DUKE
					landless = yes
					temporary = yes
					rebel = yes
					culture = PREV
					name = "SLAVE_REVOLT"
					holder = THIS
				}
				wealth = 100
				spawn_slave_army_effect = yes
			
				if = {
					limit = {
						has_game_rule = {
							name = provincial_revolt_strength
							value = powerful
						}
					}
					spawn_slave_army_effect = yes
					wealth = 150
				}
				
				if = {
					limit = {
						has_game_rule = {
							name = provincial_revolt_strength
							value = very_powerful
						}
					}
					spawn_slave_army_effect = yes
					spawn_slave_army_effect = yes
					spawn_slave_army_effect = yes
					wealth = 250
				}
				
				if = {
					limit = {
						has_game_rule = {
							name = provincial_revolt_strength
							value = extremely_powerful
						}
					}
					spawn_slave_army_effect = yes
					spawn_slave_army_effect = yes
					spawn_slave_army_effect = yes
					spawn_slave_army_effect = yes
					spawn_slave_army_effect = yes
					wealth = 350
				}
				
				# DoW on the province top liege
				ROOT = {
					owner = {
						top_liege = {
							reverse_war = {
								target = PREVPREVPREV
								casus_belli = slave_revolt
								thirdparty_title = ROOT # The county...
								tier = KING # ... but really the de jure kingdom
							}
							reverse_opinion = {
								who = PREVPREVPREV
								modifier = opinion_evil_tyrant
							}
							any_realm_province = {
								limit = {
									OR = {
										has_province_modifier = slave_modifier_1
										has_province_modifier = slave_modifier_2
										has_province_modifier = slave_modifier_3
										has_province_modifier = slave_modifier_4
										has_province_modifier = slave_modifier_5
									}
								}
								add_province_modifier = {
									name = slave_revolt_modifier
									duration = 3650
								}
							}
						}
					}
				}
			}	
		}
		
		any_province_lord = { # Inform the lieges
			character_event = {
				id = luxrevolt.1081
			}
			if = {
				limit = {
					capital_scope = { province_id = ROOT }
					is_merchant_republic = yes
				}
				any_vassal = {
					limit = { 
						is_patrician = yes
						family_palace = { has_building = fp_asoiaf_slavepit_1 } 	
					}
					character_event = { id = luxrevolt.1082 tooltip = "EVTTOOLTIPSLAVERY1001" }
				}
			}
		}
	}
}

character_event = {
	id = luxrevolt.1081
	desc = EVTDESC_TOG_106199
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_TOG_106099"
		# If relevant, remove a slave camp level
		if = {
			limit = {
				capital_scope = { province_id = FROM }
				OR = {
					any_demesne_title = {
						OR = {
							AND = {
								holding_type = castle
								has_building = ca_asoiaf_slavepit_1
							}
							AND = {
								holding_type = city
								has_building = ct_asoiaf_slavepit_1
							}
							AND = {
								holding_type = temple
								has_building = tp_asoiaf_slavepit_1
							}
						}
					}
					family_palace = {
						has_building = fp_asoiaf_slavepit_1
					}
				}
			}
			character_event = { id = slavery.1001 tooltip = "EVTTOOLTIPSLAVERY1001" }
		}
	}
}

character_event = {
	id = luxrevolt.1082
	desc = EVTDESC_TOG_106199
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_TOG_106099"
		character_event = { id = slavery.1001 tooltip = "EVTTOOLTIPSLAVERY1001" }
	}
}

# A liberator seizes a holding containing a slave camp. Fired from 'on_siege_won_leader'.
character_event = {
	id = luxrevolt.1085
	desc = "EVTDESCTOG106599"
	picture = GFX_evt_siege
	is_triggered_only = yes
	
	trigger = {
		trait = liberator
		FROM = {
			location = {
				OR = {
					has_province_modifier = slave_modifier_1
					has_province_modifier = slave_modifier_2
					has_province_modifier = slave_modifier_3
					has_province_modifier = slave_modifier_4
					has_province_modifier = slave_modifier_5
				}
			}
			OR = {
				AND = {
					holding_type = castle
					has_building = ca_asoiaf_slavepit_1
				}
				AND = {
					holding_type = city
					has_building = ct_asoiaf_slavepit_1
				}
				AND = {
					holding_type = temple
					has_building = tp_asoiaf_slavepit_1
				}
				holder_scope = {
					is_merchant_republic = yes
					capital_holding = { title = FROM }
					OR = {
						family_palace = { has_building = fp_asoiaf_slavepit_1 }
						any_vassal = { family_palace = { has_building = fp_asoiaf_slavepit_1 } }
					}
				}
			}
		}
	}
	
	option = {
		name = OK
		# Free as many slaves as you can!
		FROM = { 
			location = { set_province_flag = slave_revolt }
			holder_scope = { 
				character_event = { id = luxrevolt.1086 tooltip = "EVTTOOLTIPTOG106699" } 
				if = {
					limit = {
						capital_holding = { title = FROM }
						is_merchant_republic = yes
					}
					any_vassal = {
						limit = { 
							is_patrician = yes
							family_palace = { has_building = fp_asoiaf_slavepit_1 } 						
						}
						hidden_tooltip = { character_event = { id = luxrevolt.1087 } }
					}
				}
			} 
		}
		random = {
			chance = 30
			FROM = { location = { province_event = { id = luxrevolt.1088 tooltip = "EVTTOOLTIPTOG106899" } } }
		}
	}
}

character_event = {
	id = luxrevolt.1086
	desc = "EVTDESC_TOG_106699"
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = EVTOPTATOG106699
		if = {
			limit = {
				capital_holding = {
					title = FROMFROM
					OR = {
						AND = {
							holding_type = castle
							has_building = ca_asoiaf_slavepit_1
						}
						AND = {
							holding_type = city
							has_building = ct_asoiaf_slavepit_1
						}
						AND = {
							holding_type = temple
							has_building = tp_asoiaf_slavepit_1
						}
					}
				}
			}
			custom_tooltip = { text = LOSEALLSLAVES }
			hidden_tooltip = {
				capital_holding = {
					if = {
						limit = {
							holding_type = castle
						}
						remove_building = ca_asoiaf_slavepit_5
						remove_building = ca_asoiaf_slavepit_4
						remove_building = ca_asoiaf_slavepit_3
						remove_building = ca_asoiaf_slavepit_2
						remove_building = ca_asoiaf_slavepit_1
					}
					if = {
						limit = {
							holding_type = city
						}
						remove_building = ct_asoiaf_slavepit_5
						remove_building = ct_asoiaf_slavepit_4
						remove_building = ct_asoiaf_slavepit_3
						remove_building = ct_asoiaf_slavepit_2
						remove_building = ct_asoiaf_slavepit_1
					}
					if = {
						limit = {
							holding_type = temple
						}
						remove_building = tp_asoiaf_slavepit_5
						remove_building = tp_asoiaf_slavepit_4
						remove_building = tp_asoiaf_slavepit_3
						remove_building = tp_asoiaf_slavepit_2
						remove_building = tp_asoiaf_slavepit_1
					}
				}
			}
		}
		if = {
			limit = {
				capital_holding = { title = FROMFROM }
				is_merchant_republic = yes
				family_palace = { has_building = fp_asoiaf_slavepit_1 }
			}
			custom_tooltip = { text = LOSEALLSLAVES }
			hidden_tooltip = {
				family_palace = {
					remove_building = fp_asoiaf_slavepit_1
					remove_building = fp_asoiaf_slavepit_2
					remove_building = fp_asoiaf_slavepit_3
					remove_building = fp_asoiaf_slavepit_4
					remove_building = fp_asoiaf_slavepit_5
				}
			}
		}
	}
}

character_event = {
	id = luxrevolt.1087
	desc = "EVTDESC_TOG_106699"
	picture = GFX_evt_peasants
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTATOG106699"
		custom_tooltip = { text = LOSEALLSLAVES }
		hidden_tooltip = {
			family_palace = {
				remove_building = fp_asoiaf_slavepit_1
				remove_building = fp_asoiaf_slavepit_2
				remove_building = fp_asoiaf_slavepit_3
				remove_building = fp_asoiaf_slavepit_4
				remove_building = fp_asoiaf_slavepit_5
			}
		}
	}
}

# Liberated slaves rally to join their liberator
province_event = {
	id = luxrevolt.1088
	hide_window = yes
	is_triggered_only = yes
	
	immediate = { FROM = { character_event = { id = luxrevolt.1091 } } }
}

# Slave rebels rise up to reinforce an ongoing provincial peasant revolt
# Triggered from [s]"on_rebel_revolt"[/s] luxrevolt.1
province_event = {
	id = luxrevolt.1090
	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		set_province_flag = slave_revolt
		add_province_modifier = {
			name = recent_county_uprising
			duration = 1825 # Five years of -100% revolt risk in this county
		}
		owner = {
			top_liege = {
				any_war = {
					limit = {
						defender = { character = PREV }
						OR = {
							using_cb = slave_revolt
							using_cb = war_of_liberation
						}
					}
					attacker = { character_event = { id = luxrevolt.1091 } }
				}
				any_realm_province = {
					limit = {					
						OR = {
							has_province_modifier = slave_modifier_1
							has_province_modifier = slave_modifier_2
							has_province_modifier = slave_modifier_3
							has_province_modifier = slave_modifier_4
							has_province_modifier = slave_modifier_5
						}
						NOT = { has_province_modifier = slave_revolt_modifier }
					}
					add_province_modifier = {
						name = slave_revolt_modifier
						duration = 3650
					}
				}
			}
		}
		
		any_province_lord = { # Inform the lieges
			character_event = {
				id = luxrevolt.1092
			}
			if = {
				limit = {
					capital_scope = { province_id = ROOT }
					is_merchant_republic = yes
				}
				any_vassal = {
					limit = { family_palace = { has_building = fp_asoiaf_slavepit_1 } }
					character_event = { id = luxrevolt.1093 tooltip = "EVTTOOLTIPSLAVERY1001" }
				}
			}
		}
	}
}

character_event = {
	id = luxrevolt.1091
	desc = "EVTDESCTOG107199"
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	is_triggered_only = yes
	
	option = {
		name = OK
		spawn_slave_reinforcements_effect = yes
				
		if = {
			limit = { NOT = { demesne_size = 1 } }
			if = {
				limit = {
					has_game_rule = {
						name = provincial_revolt_strength
						value = powerful
					}
				}
				spawn_slave_reinforcements_effect = yes
			}
			
			if = {
				limit = {
					has_game_rule = {
						name = provincial_revolt_strength
						value = very_powerful
					}
				}
				spawn_slave_reinforcements_effect = yes
				spawn_slave_reinforcements_effect = yes
				spawn_slave_reinforcements_effect = yes
			}
			
			if = {
				limit = {
					has_game_rule = {
						name = provincial_revolt_strength
						value = extremely_powerful
					}
				}
				spawn_slave_reinforcements_effect = yes
				spawn_slave_reinforcements_effect = yes
				spawn_slave_reinforcements_effect = yes
				spawn_slave_reinforcements_effect = yes
				spawn_slave_reinforcements_effect = yes
			}
		}	
	}
}

character_event = {
	id = luxrevolt.1092
	desc = EVTDESC_TOG_107299
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_TOG_107099"
		# If relevant, remove a slave camp level
		if = {
			limit = {
				capital_scope = { province_id = FROM }
				OR = {
					any_demesne_title = {
						OR = {
							AND = {
								holding_type = castle
								has_building = ca_asoiaf_slavepit_1
							}
							AND = {
								holding_type = city
								has_building = ct_asoiaf_slavepit_1
							}
							AND = {
								holding_type = temple
								has_building = tp_asoiaf_slavepit_1
							}
						}
					}
					family_palace = {
						has_building = fp_asoiaf_slavepit_1
					}
				}
			}
			character_event = { id = slavery.1001 tooltip = "EVTTOOLTIPSLAVERY1001" }
		}				
	}
}

character_event = {
	id = luxrevolt.1093
	desc = EVTDESC_TOG_107299
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_TOG_107099"
		character_event = { id = slavery.1001 tooltip = "EVTTOOLTIPSLAVERY1001" }
	}
}
# Martial Rebels rise up (temporary rebel title created, with a leader and a war)
# Triggered from [s]"on_rebel_revolt"[/s] luxrevolt.1
province_event = {
	id = luxrevolt.1000
	desc = EVTDESC_luxrevolt_1000
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			random_traits = yes
			dynasty = none
			religion = ROOT
			culture = ROOT
			female = no
			age = 25
			attributes = {
				martial = 5
			}
			trait = martial_challenger
			trait = tough_soldier
			trait = strong
			trait = diligent
		}
		
		new_character = {
			set_character_flag = martial_rebel
			create_title = {
				tier = DUKE
				landless = yes
				temporary = yes
				rebel = yes
				culture = ROOT
				name = "MARTIAL_REVOLT"
				holder = THIS
			}
			
			random_list = {
				17 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.75
						troops = {
							archers = { 6 6 }
							light_cavalry = { 4 4 }
							light_infantry = { 10 10 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = martial_challenger
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.75
							troops = {
								archers = { 6 6 }
								light_cavalry = { 4 4 }
								light_infantry = { 10 10 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = martial_challenger
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.75
							troops = {
								archers = { 6 6 }
								light_cavalry = { 4 4 }
								light_infantry = { 10 10 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
				}
				17 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.5
						troops = {
							archers = { 6 6 }
							light_cavalry = { 4 4 }
							light_infantry = { 10 10 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = martial_challenger
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.5
							troops = {
								archers = { 6 6 }
								light_cavalry = { 4 4 }
								light_infantry = { 10 10 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = martial_challenger
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.5
							troops = {
								archers = { 6 6 }
								light_cavalry = { 4 4 }
								light_infantry = { 10 10 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
				}
				16 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.75
						troops = {
							archers = { 6 6 }
							light_cavalry = { 3 3 }
							light_infantry = { 11 11 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = martial_challenger
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.75
							troops = {
								archers = { 6 6 }
								light_cavalry = { 3 3 }
								light_infantry = { 11 11 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = martial_challenger
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.75
							troops = {
								archers = { 6 6 }
								light_cavalry = { 3 3 }
								light_infantry = { 11 11 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
				}
				17 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.5
						troops = {
							archers = { 6 6 }
							light_cavalry = { 3 3 }
							light_infantry = { 11 11 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = martial_challenger
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.5
							troops = {
								archers = { 6 6 }
								light_cavalry = { 3 3 }
								light_infantry = { 11 11 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = martial_challenger
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.5
							troops = {
								archers = { 6 6 }
								light_cavalry = { 3 3 }
								light_infantry = { 11 11 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
				}
				16 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.75
						troops = {
							archers = { 6 6 }
							light_infantry = { 14 14 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = martial_challenger
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.75
							troops = {
								archers = { 6 6 }
								light_infantry = { 14 14 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = martial_challenger
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.75
							troops = {
								archers = { 6 6 }
								light_infantry = { 14 14 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
				}
				17 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.5
						troops = {
							archers = { 6 6 }
							light_infantry = { 14 14 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = martial_challenger
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.5
							troops = {
								archers = { 6 6 }
								light_infantry = { 14 14 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = martial_challenger
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.5
							troops = {
								archers = { 6 6 }
								light_infantry = { 14 14 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
				}
			}
			
			# DoW on the province top liege
			ROOT = {
				owner = {
					top_liege = {
#						set_defacto_vassal = PREVPREVPREV
						reverse_war = {
							target = PREVPREVPREV
							casus_belli = martial_revolt
							thirdparty_title = ROOT # The county
						}
						reverse_opinion = {
							who = PREVPREVPREV
							modifier = opinion_evil_tyrant
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = luxrevolt.1001
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1000"
	}
}

#Inform lieges of new peasant revolt
character_event = {
	id = luxrevolt.1001
	desc = EVTDESC_luxrevolt_1001
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_TOG_1000"
	}
}

# Martial rebels seize a holding. Fired from 'on_siege_won_leader'.
character_event = {
	id = luxrevolt.1005
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		trait = martial_challenger
		rebel = yes
		FROM = { 
			is_capital = yes # The capital holding
		}
	}
	
	immediate = {
		FROM = {
			location = {
				if = {
					limit = {
						NOT = { has_province_modifier = martial_unrest }
					}
					add_province_modifier = {
						name = martial_unrest
						duration = 730
					}
				}
			}
		}
	}
}

# Martial Rebels rise up to reinforce an ongoing provincial martial revolt
# Triggered from [s]"on_rebel_revolt"[/s] luxrevolt.1
province_event = {
	id = luxrevolt.1010
	desc = EVTDESC_TOG_1010
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
	
		add_province_modifier = {
			name = recent_county_uprising
			duration = 1825 # Five years of -100% revolt risk in this county
		}
	
		owner = {
			top_liege = {
				any_war = {
					limit = {
						defender = { character = PREV }
						using_cb = martial_revolt
						war_title = ROOT # The county
					}
					attacker = {
						random_list = {
							17 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = martial_challenger
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = martial_challenger
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = martial_challenger
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
							}
							17 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = martial_challenger
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = martial_challenger
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = martial_challenger
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
							}
							16 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = martial_challenger
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = martial_challenger
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = martial_challenger
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
							}
							17 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = martial_challenger
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = martial_challenger
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = martial_challenger
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
							}
							16 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = martial_challenger
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = martial_challenger
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = martial_challenger
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
							}
							17 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = martial_challenger
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = martial_challenger
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = martial_challenger
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
							}
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = luxrevolt.1011
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1010"
	}
}

#Inform lieges of reinforced peasant revolt
character_event = {
	id = luxrevolt.1011
	desc = EVTDESC_luxrevolt_1011
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_TOG_1010"
	}
}

# Peasant Rebels rise up (temporary rebel title created, with a leader and a war)
# Triggered from [s]"on_rebel_revolt"[/s] luxrevolt.1
province_event = {
	id = luxrevolt.1020
	desc = EVTDESC_luxrevolt_1020
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			random_traits = yes
			dynasty = none
			religion = ROOT
			culture = ROOT
			female = no
			age = 25
			attributes = {
				martial = 5
			}
			trait = millenarian
			trait = tough_soldier
			trait = zealous
		}
		
		new_character = {
			set_character_flag = messianic_rebel
			create_title = {
				tier = DUKE
				landless = yes
				temporary = yes
				rebel = yes
				culture = ROOT
				name = "MESSIANIC_REVOLT"
				holder = THIS
			}
			
			wealth = 100
			
			random_list = {
				17 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.75
						troops = {
							archers = { 6 6 }
							light_cavalry = { 4 4 }
							light_infantry = { 10 10 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = millenarian
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.75
							troops = {
								archers = { 6 6 }
								light_cavalry = { 4 4 }
								light_infantry = { 10 10 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = millenarian
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.75
							troops = {
								archers = { 6 6 }
								light_cavalry = { 4 4 }
								light_infantry = { 10 10 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
				}
				17 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.5
						troops = {
							archers = { 6 6 }
							light_cavalry = { 4 4 }
							light_infantry = { 10 10 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = millenarian
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.5
							troops = {
								archers = { 6 6 }
								light_cavalry = { 4 4 }
								light_infantry = { 10 10 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = millenarian
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.5
							troops = {
								archers = { 6 6 }
								light_cavalry = { 4 4 }
								light_infantry = { 10 10 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
				}
				16 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.75
						troops = {
							archers = { 6 6 }
							light_cavalry = { 3 3 }
							light_infantry = { 11 11 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = millenarian
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.75
							troops = {
								archers = { 6 6 }
								light_cavalry = { 3 3 }
								light_infantry = { 11 11 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = millenarian
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.75
							troops = {
								archers = { 6 6 }
								light_cavalry = { 3 3 }
								light_infantry = { 11 11 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
				}
				17 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.5
						troops = {
							archers = { 6 6 }
							light_cavalry = { 3 3 }
							light_infantry = { 11 11 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = millenarian
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.5
							troops = {
								archers = { 6 6 }
								light_cavalry = { 3 3 }
								light_infantry = { 11 11 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = millenarian
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.5
							troops = {
								archers = { 6 6 }
								light_cavalry = { 3 3 }
								light_infantry = { 11 11 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
				}
				16 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.75
						troops = {
							archers = { 6 6 }
							light_infantry = { 14 14 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = millenarian
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.75
							troops = {
								archers = { 6 6 }
								light_infantry = { 14 14 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = millenarian
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.75
							troops = {
								archers = { 6 6 }
								light_infantry = { 14 14 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
				}
				17 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.5
						troops = {
							archers = { 6 6 }
							light_infantry = { 14 14 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = millenarian
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.5
							troops = {
								archers = { 6 6 }
								light_infantry = { 14 14 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = millenarian
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.5
							troops = {
								archers = { 6 6 }
								light_infantry = { 14 14 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
				}
			}
			
			# DoW on the province top liege
			ROOT = {
				owner = {
					top_liege = {
#						set_defacto_vassal = PREVPREVPREV
						reverse_war = {
							target = PREVPREVPREV
							casus_belli = messianic_revolt
							thirdparty_title = ROOT # The county
						}
						reverse_opinion = {
							who = PREVPREVPREV
							modifier = opinion_evil_tyrant
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = luxrevolt.1021
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1000"
	}
}

#Inform lieges of new peasant revolt
character_event = {
	id = luxrevolt.1021
	desc = EVTDESC_luxrevolt_1021
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_TOG_1000"
	}
}

# Peasants seize a holding. Fired from 'on_siege_won_leader'.
character_event = {
	id = luxrevolt.1025
	
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		trait = millenarian
		rebel = yes
		FROM = { 
			is_capital = yes # The capital holding
		}
	}
	
	immediate = {
		FROM = {
			location = {
				if = {
					limit = {
						NOT = { has_province_modifier = messianic_unrest }
					}
					add_province_modifier = {
						name = messianic_unrest
						duration = 730
					}
				}
			}
		}
	}
}

# Messianic Rebels rise up to reinforce an ongoing provincial messianic revolt
# Triggered from [s]"on_rebel_revolt"[/s] luxrevolt.1
province_event = {
	id = luxrevolt.1030
	desc = EVTDESC_luxrevolt_1030
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
	
		add_province_modifier = {
			name = recent_county_uprising
			duration = 1825 # Five years of -100% revolt risk in this county
		}
	
		owner = {
			top_liege = {
				any_war = {
					limit = {
						defender = { character = PREV }
						using_cb = messianic_revolt
						war_title = ROOT # The county
					}
					attacker = {
						random_list = {
							17 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = millenarian
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = millenarian
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = millenarian
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
							}
							17 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = millenarian
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = millenarian
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = millenarian
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
							}
							16 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = millenarian
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = millenarian
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = millenarian
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
							}
							17 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = millenarian
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = millenarian
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = millenarian
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
							}
							16 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = millenarian
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = millenarian
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = millenarian
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
							}
							17 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = millenarian
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = millenarian
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = millenarian
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
							}
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = luxrevolt.1031
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1010"
	}
}

#Inform lieges of reinforced peasant revolt
character_event = {
	id = luxrevolt.1031
	desc = EVTDESC_luxrevolt_1031
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_TOG_1010"
	}
}

# Peasant Rebels rise up (temporary rebel title created, with a leader and a war)
# Triggered from [s]"on_rebel_revolt"[/s] luxrevolt.1
province_event = {
	id = luxrevolt.1040
	desc = EVTDESC_TOG_1000
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
		create_character = {
			random_traits = yes
			dynasty = none
			religion = ROOT
			culture = ROOT
			female = no
			age = 25
			attributes = {
				martial = 5
			}
			trait = revolutionary
			trait = tough_soldier
			trait = charitable
			trait = kind
		}
		
		new_character = {
			set_character_flag = populist_rebel
			create_title = {
				tier = COUNT
				landless = yes
				temporary = yes
				rebel = yes
				culture = ROOT
				name = "POPULIST_REVOLT"
				holder = THIS
			}
			
			wealth = 100
			
			random_list = {
				17 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.75
						troops = {
							archers = { 6 6 }
							light_cavalry = { 4 4 }
							light_infantry = { 10 10 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = revolutionary
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.75
							troops = {
								archers = { 6 6 }
								light_cavalry = { 4 4 }
								light_infantry = { 10 10 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = revolutionary
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.75
							troops = {
								archers = { 6 6 }
								light_cavalry = { 4 4 }
								light_infantry = { 10 10 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
				}
				17 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.5
						troops = {
							archers = { 6 6 }
							light_cavalry = { 4 4 }
							light_infantry = { 10 10 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = revolutionary
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.5
							troops = {
								archers = { 6 6 }
								light_cavalry = { 4 4 }
								light_infantry = { 10 10 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = revolutionary
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.5
							troops = {
								archers = { 6 6 }
								light_cavalry = { 4 4 }
								light_infantry = { 10 10 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
				}
				16 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.75
						troops = {
							archers = { 6 6 }
							light_cavalry = { 3 3 }
							light_infantry = { 11 11 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = revolutionary
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.75
							troops = {
								archers = { 6 6 }
								light_cavalry = { 3 3 }
								light_infantry = { 11 11 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = revolutionary
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.75
							troops = {
								archers = { 6 6 }
								light_cavalry = { 3 3 }
								light_infantry = { 11 11 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
				}
				17 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.5
						troops = {
							archers = { 6 6 }
							light_cavalry = { 3 3 }
							light_infantry = { 11 11 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = revolutionary
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.5
							troops = {
								archers = { 6 6 }
								light_cavalry = { 3 3 }
								light_infantry = { 11 11 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = revolutionary
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.5
							troops = {
								archers = { 6 6 }
								light_cavalry = { 3 3 }
								light_infantry = { 11 11 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
				}
				16 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.75
						troops = {
							archers = { 6 6 }
							light_infantry = { 14 14 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = revolutionary
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.75
							troops = {
								archers = { 6 6 }
								light_infantry = { 14 14 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = revolutionary
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.75
							troops = {
								archers = { 6 6 }
								light_infantry = { 14 14 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
				}
				17 = {
					spawn_unit = {
						province = ROOT
						home = ROOT
						owner = THIS
						leader = THIS
						scaled_by_biggest_garrison = 0.5
						troops = {
							archers = { 6 6 }
							light_infantry = { 14 14 }
						}
						attrition = 1.0
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 30
						trait = revolutionary
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.5
							troops = {
								archers = { 6 6 }
								light_infantry = { 14 14 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
					create_character = {
						random_traits = yes
						dynasty = none
						religion = THIS
						culture = THIS
						female = no
						age = 31
						trait = revolutionary
						trait = tough_soldier
					}
					new_character = {
						spawn_unit = {
							province = ROOT
							home = ROOT
							owner = PREV
							scaled_by_biggest_garrison = 0.5
							troops = {
								archers = { 6 6 }
								light_infantry = { 14 14 }
							}
							attrition = 1.0
							disband_on_peace = yes
						}
					}
				}
			}
			
			# DoW on the province top liege
			ROOT = {
				owner = {
					top_liege = {
#						set_defacto_vassal = PREVPREVPREV
						reverse_war = {
							target = PREVPREVPREV
							casus_belli = populist_revolt
							thirdparty_title = ROOT # The county
						}
						reverse_opinion = {
							who = PREVPREVPREV
							modifier = opinion_evil_tyrant
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = luxrevolt.1041
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1000"
	}
}

#Inform lieges of new peasant revolt
character_event = {
	id = luxrevolt.1041
	desc = EVTDESC_luxrevolt_1041
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_TOG_1000"
	}
}

# Peasants seize a holding. Fired from 'on_siege_won_leader'.
character_event = {
	id = luxrevolt.1045
	
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		trait = revolutionary
		rebel = yes
		FROM = { 
			is_capital = yes # The capital holding
		}
	}
	
	immediate = {
		FROM = {
			location = {
				if = {
					limit = {
						NOT = { has_province_modifier = populist_unrest }
					}
					add_province_modifier = {
						name = populist_unrest
						duration = 730
					}
				}
			}
		}
	}
}

# Peasant Rebels rise up to reinforce an ongoing provincial peasant revolt
# Triggered from [s]"on_rebel_revolt"[/s] luxrevolt.1
province_event = {
	id = luxrevolt.1050
	desc = EVTDESC_luxrevolt_1050
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	immediate = {
	
		add_province_modifier = {
			name = recent_county_uprising
			duration = 1825 # Five years of -100% revolt risk in this county
		}
	
		owner = {
			top_liege = {
				any_war = {
					limit = {
						defender = { character = PREV }
						using_cb = populist_revolt
						war_title = ROOT # The county
					}
					attacker = {
						random_list = {
							17 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = revolutionary
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = revolutionary
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = revolutionary
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
							}
							17 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = revolutionary
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = revolutionary
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = revolutionary
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_cavalry = { 4 4 }
											light_infantry = { 10 10 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
							}
							16 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = revolutionary
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = revolutionary
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = revolutionary
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
							}
							17 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = revolutionary
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = revolutionary
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = revolutionary
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_cavalry = { 3 3 }
											light_infantry = { 11 11 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
							}
							16 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = revolutionary
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = revolutionary
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = revolutionary
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.75
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
							}
							17 = {
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 25
									trait = revolutionary
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 30
									trait = revolutionary
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
								create_character = {
									random_traits = yes
									dynasty = none
									religion = THIS
									culture = THIS
									female = no
									age = 31
									trait = revolutionary
									trait = tough_soldier
								}
								new_character = {
									spawn_unit = {
										province = ROOT
										home = ROOT
										owner = PREV
										scaled_by_biggest_garrison = 0.5
										troops = {
											archers = { 6 6 }
											light_infantry = { 14 14 }
										}
										attrition = 1.0
										disband_on_peace = yes
									}
								}
							}
						}
					}
				}
			}
		}
		
		owner = {
			any_liege = { # Inform the lieges
				character_event = {
					id = luxrevolt.1051
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTA_TOG_1010"
	}
}

#Inform lieges of reinforced peasant revolt
character_event = {
	id = luxrevolt.1051
	desc = EVTDESC_luxrevolt_1051
	picture = GFX_evt_peasants
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_TOG_1010"
	}
}
